<!DOCTYPE html>
<html>

<head>
  <script type="text/javascript">
    var tableToExcel = (function () {
      var uri = 'data:application/vnd.ms-excel;base64,'
        , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DoNotDisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/><style>table{width:100%;border-collapse:collapse;margin:24px 0;font-size:16px;background:#fff}th,td{padding:12px 18px;text-align:left;vertical-align:middle}th{background-color:#f2f2f2;color:#000;font-weight:600}.no-border-row td,.no-border-row th{border:none!important;mso-border-alt:none!important}.no-border-cell,.no-right-border{border:none!important;mso-border-alt:none!important}.title-row td,.title-row th{text-align:center!important;font-weight:700!important}</style></head><body><table style="border-collapse:collapse;width:100%">{table}</table></body></html>'
        , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
        , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
      return function (table, name) {
        if (!table.nodeType) table = document.getElementById(table)
        var working = table.cloneNode(true)
        var applyNoBorderInline = function (cell) {
          if (!cell || !cell.style) return
          cell.style.border = 'none'
          cell.style.borderTop = 'none'
          cell.style.borderRight = 'none'
          cell.style.borderBottom = 'none'
          cell.style.borderLeft = 'none'
          cell.style.cssText += ';mso-border-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-left-alt:none;'
        }
        var applyBorderInline = function (cell) {
          if (!cell || !cell.style) return
          cell.style.border = '1px solid #000'
          cell.style.borderTop = '1px solid #000'
          cell.style.borderRight = '1px solid #000'
          cell.style.borderBottom = '1px solid #000'
          cell.style.borderLeft = '1px solid #000'
          cell.style.cssText += ';mso-border-top-alt:solid-windowtext .5pt;mso-border-right-alt:solid-windowtext .5pt;mso-border-bottom-alt:solid-windowtext .5pt;mso-border-left-alt:solid-windowtext .5pt;'
        }
        try {
          var allCells = working.querySelectorAll('th, td')
          allCells && allCells.forEach(function (cell) {
            var tr = cell.parentElement
            var isRowNoBorder = tr && tr.classList && tr.classList.contains('no-border-row')
            var isCellNoBorder = cell.classList && (cell.classList.contains('no-border-cell') || cell.classList.contains('no-right-border'))
            if (isRowNoBorder || isCellNoBorder) {
              applyNoBorderInline(cell)
            } else {
              applyBorderInline(cell)
            }
          })
          var titleCells = working.querySelectorAll('tr.title-row th, tr.title-row td')
          titleCells && titleCells.forEach(function (cell) {
            if (!cell || !cell.style) return
            cell.style.textAlign = 'center'
            cell.setAttribute('align', 'center')
            cell.style.fontWeight = '700'
            cell.style.cssText += ';mso-font-weight:bold;text-align:center;'
            cell.innerHTML = '<b>' + cell.innerHTML + '</b>'
          })
        } catch (e) { /* noop */ }
        var ctx = { worksheet: name || 'Worksheet', table: working.innerHTML }
        window.location.href = uri + base64(format(template, ctx))
      }
    })()
  </script>
  <meta http-equiv="content-type" content="text/plain; charset=UTF-8" />

  <title>Vacancy Applicants Report</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 24px 0;
      font-size: 16px;
      background: #fff;
    }

    th,
    td {
      padding: 12px 18px;
      border: 1px solid #000;
      text-align: left;
      vertical-align: middle;
    }

    th {
      background-color: #f2f2f2;
      color: #000;
      font-weight: 600;
    }

    body {
      font-family: 'Segoe UI', 'Tahoma', 'Geneva', 'Verdana', sans-serif;
      color: #22223b;
      background: #f4f6fa;
      margin: 0;
      padding: 0;
    }

    .container {
      padding: 1.5rem;
    }

    .title-row th,
    .title-row td {
      text-align: center;
      font-weight: 700;
    }

    @media (max-width: 768px) {

      table,
      th,
      td {
        font-size: 14px;
        padding: 8px 6px;
      }
    }
  </style>
</head>

<body>
  <button onclick="tableToExcel('mainTable', 'Vacancy Applicants Report')">Export to Excel</button>
  <div class="container">
    <table id="mainTable">
      <tbody>
        <tr class="title-row">
          <td colspan="8">Vacancy Applicants Report (बि.नं.: {{bigyapanNo}})</td>
        </tr>
        <tr>
          <th>Applicant Name</th>
          <th>Employee ID</th>
          <th>Seniority Marks</th>
          <th>Geographical Marks</th>
          <th>Education Marks</th>
          <th>Training Marks</th>
          <th>Total Marks</th>
          <th>Ranking</th>
        </tr>
        {{#if applicants}}
        {{#each applicants}}
        <tr>
          <td>{{this.name}}</td>
          <td>{{this.employeeId}}</td>
          <td>{{toFixed this.seniorityMarks 4}}</td>
          <td>{{toFixed this.geographicalMarks 4}}</td>
          <td>{{toFixed this.educationMarks 4}}</td>
          <td>{{toFixed this.trainingMarks 4}}</td>
          <td>{{toFixed this.totalMarks 4}}</td>
          <td>{{this.rank}}</td>
        </tr>
        {{/each}}
        {{/if}}
      </tbody>
    </table>
  </div>
</body>

</html>

